<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AI 学习记录 · 个人简历</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="bg-orb orb-a"></div>
  <div class="bg-orb orb-b"></div>
  <div class="bg-grid"></div>

  <main class="page">
    <nav class="nav card reveal" style="--delay: 0ms;">
      <a href="#hero">名片</a>
      <a href="#cards">教学内容</a>
      <a href="#showcase">成果展示</a>
      <a href="#assistant">AI问答</a>
    </nav>

    <header id="hero" class="hero card reveal" style="--delay: 0ms;">
      <div class="hero-media">
        <div class="avatar-frame">
          <img src="avatar.jpg" alt="Q版形象" />
        </div>
        <div class="badge">个人名片</div>
      </div>
      <div class="hero-content">
        <p class="eyebrow">AI 学习记录</p>
        <h1>教学卡片整理与成果展示</h1>
        <p class="subhead">
          聚焦学习准备、工具认知、提示词工程与创作实践的阶段性总结。
        </p>
        <div class="chip-row">
          <span class="chip">学习准备</span>
          <span class="chip">提示词工程</span>
          <span class="chip">文生图实践</span>
        </div>
      </div>
    </header>

    <section id="cards" class="card reveal" style="--delay: 120ms;">
      <div class="section-title">
        <h2>教学内容</h2>
        <span>横向卡片展示（点击查看详细内容）</span>
      </div>
      <div class="lesson-row">
        <div class="lesson-card">
          <img class="lesson-thumb" src="card1.png" alt="教学卡片1配图" />
          <h3>教学卡片 1</h3>
          <p>AI 学习前期准备工作</p>
          <button class="detail-btn" type="button">详细内容</button>
          <div class="lesson-detail">
            <div class="lesson-block">
              <strong>内容</strong>
              <p>任务卡片已阅读；解决网络与支付问题，Gemini 因账号问题暂不考虑，先使用 ChatGPT。</p>
            </div>
            <div class="lesson-block">
              <strong>收获</strong>
              <p>明确了学习前置条件与工具选择，问题已闭环解决。</p>
            </div>
          </div>
        </div>
        <div class="lesson-card">
          <img class="lesson-thumb" src="card2.jpg" alt="教学卡片2配图" />
          <h3>教学卡片 2</h3>
          <p>工具认知与学习方式</p>
          <button class="detail-btn" type="button">详细内容</button>
          <div class="lesson-detail">
            <div class="lesson-block">
              <strong>内容</strong>
              <p>了解主流模型与工具；学习提示词工程；熟悉 Markdown 与 Json；开始使用 Notion。</p>
            </div>
            <div class="lesson-block">
              <strong>主流工具</strong>
              <div class="tool-grid">
                <a class="tool-card" href="https://www.deepseek.com" target="_blank" rel="noreferrer">
                  <span>DeepSeek</span>
                  <div class="tool-pop">深度求索推出的高性能对话模型。</div>
                </a>
                <a class="tool-card" href="https://gemini.google.com" target="_blank" rel="noreferrer">
                  <span>Gemini</span>
                  <div class="tool-pop">Google 推出的多模态 AI 模型。</div>
                </a>
                <a class="tool-card" href="https://www.anthropic.com" target="_blank" rel="noreferrer">
                  <span>Claude</span>
                  <div class="tool-pop">Anthropic 出品，长上下文与安全性著称。</div>
                </a>
                <a class="tool-card" href="https://tongyi.aliyun.com" target="_blank" rel="noreferrer">
                  <span>通义千问</span>
                  <div class="tool-pop">阿里云推出的通用大模型助手。</div>
                </a>
                <a class="tool-card" href="https://kimi.moonshot.cn" target="_blank" rel="noreferrer">
                  <span>Kimi Chat</span>
                  <div class="tool-pop">月之暗面出品，支持超长文本处理。</div>
                </a>
                <a class="tool-card" href="https://www.midjourney.com" target="_blank" rel="noreferrer">
                  <span>Midjourney</span>
                  <div class="tool-pop">顶尖的提示词驱动艺术生成工具。</div>
                </a>
                <a class="tool-card" href="https://openai.com/sora" target="_blank" rel="noreferrer">
                  <span>Sora</span>
                  <div class="tool-pop">OpenAI 开发的文生视频模型。</div>
                </a>
                <a class="tool-card" href="https://github.com/features/copilot" target="_blank" rel="noreferrer">
                  <span>GitHub Copilot</span>
                  <div class="tool-pop">GitHub 与 OpenAI 联合开发的代码补全工具。</div>
                </a>
                <a class="tool-card" href="https://suno.com" target="_blank" rel="noreferrer">
                  <span>Suno</span>
                  <div class="tool-pop">领先的 AI 音乐生成工具。</div>
                </a>
                <a class="tool-card" href="https://www.coze.com" target="_blank" rel="noreferrer">
                  <span>扣子/Coze</span>
                  <div class="tool-pop">字节跳动推出的 AI Bot 开发平台。</div>
                </a>
              </div>
            </div>
            <div class="lesson-block">
              <strong>收获</strong>
              <p>形成工具全景认知，初步掌握提示词结构化表达。</p>
            </div>
          </div>
        </div>
        <div class="lesson-card">
          <img class="lesson-thumb" src="card3.png" alt="教学卡片3配图" />
          <h3>教学卡片 3</h3>
          <p>创作实践与提示词总结</p>
          <button class="detail-btn" type="button">详细内容</button>
          <div class="lesson-detail">
            <div class="lesson-block">
              <strong>内容</strong>
              <p>使用即梦生成赛博朋克风格图片，练习文生图提示词要素与镜头表达。</p>
            </div>
            <div class="lesson-block">
              <strong>收获</strong>
              <p>理解提示词精细度与生成结果偏差的权衡关系。</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="showcase" class="card reveal" style="--delay: 360ms;">
      <div class="section-title">
        <h2>成果展示</h2>
        <span>作品预览</span>
      </div>
      <div class="showcase">
        <img src="onepiece.png?v=1" alt="成果展示 - 海贼王" />
        <video controls preload="metadata" playsinline>
          <source src="boarding.mp4?v=1" type="video/mp4" />
          浏览器不支持视频播放。
        </video>
      </div>
    </section>

    <section id="assistant" class="card reveal" style="--delay: 460ms;">
      <div class="section-title">
        <h2>AI 问答助手</h2>
        <span>已内置教学卡片 1-3 的知识库</span>
      </div>
      <div class="assistant">
        <div class="assistant-log" id="assistantLog">
          <div class="assistant-msg bot">
            你好，我已存储教学卡片 1-3 的内容。输入问题，我会基于这些学习内容进行回答。
          </div>
        </div>
        <div class="assistant-actions">
          <button class="chip-btn" type="button" data-q="主流AI工具有哪些？">主流AI工具有哪些？</button>
          <button class="chip-btn" type="button" data-q="提示词工程需要注意什么？">提示词工程需要注意什么？</button>
          <button class="chip-btn" type="button" data-q="你学到的前期准备有哪些？">你学到的前期准备有哪些？</button>
        </div>
        <form class="assistant-input" id="assistantForm">
          <input type="text" id="assistantQuery" placeholder="输入问题，例如：Markdown 和 Json 的区别？" />
          <button type="submit">发送</button>
        </form>
      </div>
    </section>
  </main>

  <button class="to-top" type="button" aria-label="返回顶部">↑</button>
  <div class="modal" id="lessonModal" aria-hidden="true">
    <div class="modal-backdrop" data-close="true"></div>
    <div class="modal-card" role="dialog" aria-modal="true">
      <div class="modal-header">
        <h3 id="modalTitle">教学内容</h3>
        <button class="modal-close" type="button" data-close="true">×</button>
      </div>
      <div class="modal-body" id="modalBody"></div>
    </div>
  </div>

  <script>
    const topButton = document.querySelector(".to-top");
    const navLinks = Array.from(document.querySelectorAll(".nav a"));
    const sections = navLinks
      .map((link) => document.querySelector(link.getAttribute("href")))
      .filter(Boolean);

    const setActive = (id) => {
      navLinks.forEach((link) => {
        const isActive = link.getAttribute("href") === `#${id}`;
        link.classList.toggle("active", isActive);
      });
    };

    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            setActive(entry.target.id);
          }
        });
      },
      { rootMargin: "-25% 0px -55% 0px", threshold: 0.2 }
    );

    sections.forEach((section) => observer.observe(section));

    const updateActiveByScroll = () => {
      const marker = window.scrollY + window.innerHeight * 0.35;
      let current = sections[0];

      sections.forEach((section) => {
        if (section.offsetTop <= marker) {
          current = section;
        }
      });

      if (current) {
        setActive(current.id);
      }
    };

    window.addEventListener("scroll", () => {
      const show = window.scrollY > 240;
      topButton.classList.toggle("visible", show);
      updateActiveByScroll();
    });

    navLinks.forEach((link) => {
      link.addEventListener("click", () => {
        const id = link.getAttribute("href").slice(1);
        setActive(id);
      });
    });

    topButton.addEventListener("click", () => {
      window.scrollTo({ top: 0, behavior: "smooth" });
    });

    if (sections.length) {
      setActive(sections[0].id);
    }

    const modal = document.getElementById("lessonModal");
    const modalTitle = document.getElementById("modalTitle");
    const modalBody = document.getElementById("modalBody");

    document.querySelectorAll(".detail-btn").forEach((btn) => {
      btn.addEventListener("click", () => {
        const card = btn.closest(".lesson-card");
        const title = card.querySelector("h3").textContent;
        const detail = card.querySelector(".lesson-detail");
        modalTitle.textContent = title;
        modalBody.innerHTML = detail.innerHTML;
        modal.classList.add("open");
        modal.setAttribute("aria-hidden", "false");
      });
    });

    modal.addEventListener("click", (event) => {
      if (event.target.dataset.close) {
        modal.classList.remove("open");
        modal.setAttribute("aria-hidden", "true");
      }
    });

    document.addEventListener("keydown", (event) => {
      if (event.key === "Escape" && modal.classList.contains("open")) {
        modal.classList.remove("open");
        modal.setAttribute("aria-hidden", "true");
      }
    });

    const assistantLog = document.getElementById("assistantLog");
    const assistantForm = document.getElementById("assistantForm");
    const assistantQuery = document.getElementById("assistantQuery");

    const appendMessage = (text, role) => {
      const div = document.createElement("div");
      div.className = `assistant-msg ${role}`;
      div.textContent = text;
      if (role === "bot") {
        const copy = document.createElement("button");
        copy.type = "button";
        copy.className = "copy-btn";
        copy.textContent = "复制";
        copy.addEventListener("click", () => {
          navigator.clipboard.writeText(text).then(() => {
            copy.textContent = "已复制";
            setTimeout(() => {
              copy.textContent = "复制";
            }, 1200);
          });
        });
        div.appendChild(copy);
      }
      assistantLog.appendChild(div);
      assistantLog.scrollTop = assistantLog.scrollHeight;
    };

    const appendTyping = (text) => {
      const div = document.createElement("div");
      div.className = "assistant-msg bot typing";
      const span = document.createElement("span");
      div.appendChild(span);
      const copy = document.createElement("button");
      copy.type = "button";
      copy.className = "copy-btn";
      copy.textContent = "复制";
      copy.disabled = true;
      div.appendChild(copy);
      assistantLog.appendChild(div);
      assistantLog.scrollTop = assistantLog.scrollHeight;

      let index = 0;
      const step = () => {
        span.textContent = text.slice(0, index);
        index += 1;
        assistantLog.scrollTop = assistantLog.scrollHeight;
        if (index <= text.length) {
          setTimeout(step, 18);
        } else {
          div.classList.remove("typing");
          copy.disabled = false;
          copy.addEventListener("click", () => {
            navigator.clipboard.writeText(text).then(() => {
              copy.textContent = "已复制";
              setTimeout(() => {
                copy.textContent = "复制";
              }, 1200);
            });
          });
        }
      };

      step();
    };

    const appendLoading = () => {
      const div = document.createElement("div");
      div.className = "assistant-msg bot loading";
      div.innerHTML = "<span></span><span></span><span></span>";
      assistantLog.appendChild(div);
      assistantLog.scrollTop = assistantLog.scrollHeight;
      return div;
    };

    const chatHistory = [
      {
        role: "assistant",
        content:
          "你好，我已存储教学卡片 1-3 的内容。输入问题，我会基于这些学习内容进行回答。",
      },
    ];

    const requestAnswer = async (query) => {
      chatHistory.push({ role: "user", content: query });
      const response = await fetch("/api/chat", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ messages: chatHistory }),
      });

      if (!response.ok) {
        const text = await response.text();
        throw new Error(text || "请求失败");
      }

      const data = await response.json();
      const reply = data.reply || "暂时没有返回内容，请稍后再试。";
      chatHistory.push({ role: "assistant", content: reply });
      return reply;
    };

    assistantForm.addEventListener("submit", (event) => {
      event.preventDefault();
      const query = assistantQuery.value.trim();
      if (!query) return;
      appendMessage(query, "user");
      const loader = appendLoading();
      requestAnswer(query)
        .then((answer) => {
          loader.remove();
          appendTyping(answer);
        })
        .catch(() => {
          loader.remove();
          appendTyping("当前服务暂不可用，请稍后再试。");
        });
      assistantQuery.value = "";
    });

    document.querySelectorAll(".chip-btn").forEach((btn) => {
      btn.addEventListener("click", () => {
        const query = btn.dataset.q;
        appendMessage(query, "user");
        const loader = appendLoading();
        requestAnswer(query)
          .then((answer) => {
            loader.remove();
            appendTyping(answer);
          })
          .catch(() => {
            loader.remove();
            appendTyping("当前服务暂不可用，请稍后再试。");
          });
      });
    });
  </script>
</body>
</html>
